var AppDocumento=angular.module("AppDocumento",[]);function createController(o,n){o.filtroproduto="",o.snProdutoFiltradoExiste=null,o.snAtualizandoVenda=!1,o.arrDadosVenda={id_documento:null,vl_total_documento:0,sn_documento_confirmado:!1,sn_documento_cancelado:!1},o.arrProdutosVenda=[],o.realizarFiltro=function(){if(o.snProdutoFiltradoExiste=null,o.snAtualizandoVenda)return!1;o.snAtualizandoVenda=!0;let d={filtroproduto:o.filtroproduto};n.post("produto/get-venda",d).success(function(n){if(0==n.dados.length)return o.snProdutoFiltradoExiste=!1,o.snAtualizandoVenda=!1,!1;let d=n.dados[0];o.arrProdutosVenda.push(d),o.filtroproduto="",o.atualizaVenda(d.id_produto,d.vl_produto)})},o.atualizaVenda=function(d,t){if(null==o.arrDadosVenda.id_documento)return o.setVenda(d,t),!1;o.arrDadosVenda.vl_total_documento=o.arrDadosVenda.vl_total_documento+t;let a={id_produto:d,id_documento:o.arrDadosVenda.id_documento,vl_total_documento:o.arrDadosVenda.vl_total_documento,sn_documento_confirmado:o.arrDadosVenda.sn_documento_confirmado,sn_documento_cancelado:o.arrDadosVenda.sn_documento_cancelado};n.post("documento/update-produto",a).success(function(n){o.snAtualizandoVenda=!1})},o.setVenda=function(d,t){let a={id_produto:d,vl_total_documento:t};o.arrDadosVenda.vl_total_documento=t,n.post("documento/set",a).success(function(n){o.arrDadosVenda.id_documento=n.dados.id_documento,o.snAtualizandoVenda=!1})},o.confirmarVenda=function(){if(o.snAtualizandoVenda)return!1;o.snAtualizandoVenda=!0;let d={sn_documento_confirmado:!0,sn_documento_cancelado:!1,vl_total_documento:o.arrDadosVenda.vl_total_documento,id_documento:o.arrDadosVenda.id_documento};n.post("documento/update",d).success(function(n){o.novaVenda()})},o.cancelarVenda=function(){if(o.snAtualizandoVenda)return!1;o.snAtualizandoVenda=!0;let d={sn_documento_confirmado:!1,sn_documento_cancelado:!0,vl_total_documento:o.arrDadosVenda.vl_total_documento,id_documento:o.arrDadosVenda.id_documento};n.post("documento/update",d).success(function(n){o.novaVenda()})},o.novaVenda=function(){o.filtroproduto="",o.snProdutoFiltradoExiste=null,o.snAtualizandoVenda=!1,o.arrDadosVenda={id_documento:null,vl_total_documento:0,sn_documento_confirmado:!1,sn_documento_cancelado:!1},o.arrProdutosVenda=[]}}AppDocumento.controller("DocumentoController",["$scope","$http",createController]);